{"ast":null,"code":"import _regeneratorRuntime from \"/opt/homebrew/var/www/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/opt/homebrew/var/www/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nvar state = {\n  token: localStorage.getItem('token') || '',\n  status: ''\n};\nvar getters = {\n  isLoggedIn: function isLoggedIn(state) {\n    return !!state.token;\n  },\n  authStatus: function authStatus(state) {\n    return state.status;\n  }\n};\nvar actions = {\n  login: function () {\n    var _login = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref, credentials) {\n      var commit, _data$authorization, response, data, token;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            commit = _ref.commit;\n            _context.prev = 1;\n            _context.next = 4;\n            return fetch('http://127.0.0.1:8000/api/login', {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify(credentials)\n            });\n          case 4:\n            response = _context.sent;\n            _context.next = 7;\n            return response.json();\n          case 7:\n            data = _context.sent;\n            if (response.ok) {\n              _context.next = 10;\n              break;\n            }\n            throw new Error(data.message || 'Failed to login');\n          case 10:\n            console.log(data);\n            token = data === null || data === void 0 || (_data$authorization = data.authorization) === null || _data$authorization === void 0 ? void 0 : _data$authorization.token;\n            localStorage.setItem('token', token);\n            commit('loginSuccess', token);\n\n            // Return the success response to handle routing in the Vue component\n            return _context.abrupt(\"return\", {\n              success: true\n            });\n          case 17:\n            _context.prev = 17;\n            _context.t0 = _context[\"catch\"](1);\n            commit('loginFailure', _context.t0.message);\n\n            // Return the error response to handle routing in the Vue component\n            return _context.abrupt(\"return\", {\n              success: false,\n              message: _context.t0.message\n            });\n          case 21:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[1, 17]]);\n    }));\n    function login(_x, _x2) {\n      return _login.apply(this, arguments);\n    }\n    return login;\n  }(),\n  logout: function logout(_ref2) {\n    var commit = _ref2.commit;\n    localStorage.removeItem('token');\n    commit('logout');\n  }\n};\nvar mutations = {\n  loginSuccess: function loginSuccess(state, token) {\n    state.token = token;\n    state.status = 'success';\n  },\n  loginFailure: function loginFailure(state, errorMessage) {\n    state.token = '';\n    state.status = errorMessage;\n  },\n  logout: function logout(state) {\n    state.token = '';\n  }\n};\nexport default {\n  state: state,\n  getters: getters,\n  actions: actions,\n  mutations: mutations\n};","map":{"version":3,"names":["state","token","localStorage","getItem","status","getters","isLoggedIn","authStatus","actions","login","_login","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","credentials","commit","_data$authorization","response","data","wrap","_callee$","_context","prev","next","fetch","method","headers","body","JSON","stringify","sent","json","ok","Error","message","console","log","authorization","setItem","abrupt","success","t0","stop","_x","_x2","apply","arguments","logout","_ref2","removeItem","mutations","loginSuccess","loginFailure","errorMessage"],"sources":["/opt/homebrew/var/www/frontend/src/store/auth.js"],"sourcesContent":["const state = {\n    token: localStorage.getItem('token') || '',\n    status: '',\n  };\n  \n  const getters = {\n    isLoggedIn: (state) => !!state.token,\n    authStatus: (state) => state.status,\n  };\n  \n  const actions = {\n    login: async ({ commit }, credentials) => {\n      try {\n        const response = await fetch('http://127.0.0.1:8000/api/login', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify(credentials),\n        });\n  \n        const data = await response.json();\n  \n        if (!response.ok) {\n          throw new Error(data.message || 'Failed to login');\n        }\n\n        console.log(data);\n  \n        const token = data?.authorization?.token;\n        localStorage.setItem('token', token);\n        commit('loginSuccess', token);\n  \n\n        // Return the success response to handle routing in the Vue component\n        return { success: true };\n      } catch (error) {\n        commit('loginFailure', error.message);\n  \n        // Return the error response to handle routing in the Vue component\n        return { success: false, message: error.message };\n      }\n    },\n    logout: ({ commit }) => {\n      localStorage.removeItem('token');\n      commit('logout');\n    },\n  };\n  \n  const mutations = {\n    loginSuccess: (state, token) => {\n      state.token = token;\n      state.status = 'success';\n    },\n    loginFailure: (state, errorMessage) => {\n      state.token = '';\n      state.status = errorMessage;\n    },\n    logout: (state) => {\n      state.token = '';\n    },\n  };\n  \n  export default {\n    state,\n    getters,\n    actions,\n    mutations,\n  };\n  "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}